{% extends 'base.html' %}

{% block body %}
<div class="flex-container-generic">
    <div class="page-header">
        <h1> Participant Details - {{participant.fname}} {{participant.lname}} </h1>
    </div>
    <div class="flex-row">
        <div class="flex-box-generic">
            <ul id="participant-info">
                <li><h2>name: {{participant.fname}} {{participant.lname}}</h2></li>
                <li><h2>participant ID: <span id="participant-id">{{participant.participant_id}}</span></h2></li>
                <li id="email">email: <span>{{participant.email}}</span></li>
                <li id="phone">phone: <span>{{participant.phone}}</span></li>
                <li>dob: {{participant.dob}}</li>
            </ul>
        </div>

        <div class="flex-box-generic">
            <ul id="participant-hcp-info">
                <li><h2 id="hcp_fullname">doctor name: <span>{{participant.hcp_fullname}}</span></h2></li>
                <li id="hcp_email">email: <span >{{participant.hcp_email}}</span></li>
                <li id="hcp_phone">phone: <span >{{participant.hcp_phone}}</span></li>
                <li id="hcp_practice">practice: <span >{{participant.hcp_practice}}</span></li>
            </ul>
        </div>
    </div>
        <div id="update-success" class="flex-center"></div><br>
        <button id="update-details-button" class="button">Update Information</button>


    <h3>studies that participant is in: </h3>
    {% for study in participant.studies %}
    <h3><b>study:</b> {{study.study_name}}</h3> 
    <p><b>status:</b> {{study.status_code}}</p> 
    <p><b>ID:</b> {{study.study_id}}</p> 
    <h3>results that will be returned from {{study.study_name}} and your decisions:</h3>
    <p><a href="/decisions/{{study.study_id}}/{{participant.participant_id}}">click here to update decisions</a></p>
    {% for decision in participant.return_decisions %} 
        {% for result_plan in study.result_plans %} 
            {% if decision.result_plan_id == result_plan.result_plan_id and result_plan.return_plan == True %}
                <li><b>visit:</b> {{result_plan.visit}}<br>
                    <b>test name:</b> {{decision.result_plan.test_name}}<br>
                    <b>decision:</b> {{decision.return_decision}}</li>
            {% endif %}
        {% endfor %}
    {% endfor %}
    {% endfor %}

    <h3>results that belong to a participant</h3>
    {% for result in participant.results %}
    <li><b>study: {{result.result_plan.study.study_name}}</b>
        <b>visit:</b> {{result.result_plan.visit}}<br>
        <b>test name:</b> {{result.result_plan.test_name}}<br>
        <b>test value:</b> {{result.result_value}}</li>
    

    {% endfor %}

</div>

{% endblock %}

{% block js %} 
<script src="/static/js/update-details.js"></script>
{% endblock %}